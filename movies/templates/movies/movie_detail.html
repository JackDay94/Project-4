{% extends 'base.html' %}
{% load crispy_forms_tags %}

{% block title %}
ReviewVie - {{ movie.name }}
{% endblock %}

{% block content %}
<div class="container-fluid">
    {% if request.user.is_superuser %}
    <div class="row justify-content-center pt-3">
        <button type="button" class="me-1 btn btn-dark movie-btn">Edit</button>
        <button type="button" class="ms-1 btn btn-danger movie-btn">Delete</button>
    </div>
    {% endif %}
    <div class="row">
        <div class="col-12 text-center pt-3" id="top-movie">
            {% if "placeholder" in movie.image.url %}
            <img src="https://via.placeholder.com/800.png?text=Movie+Awaiting+Image" alt="{{ movie.name }}"
                class="top-movie-img">
            {% else %}
            <img src="{{ movie.image.url }}" alt="{{ movie.name }}" class="top-movie-img">
            {% endif %}
        </div>
        <div class="col-12 text-center pt-3">
            <h1 class="fw-bold">{{ movie.name }} </h1>
            {% with reviews.count as total_reviews %}
            <h2 class="fw-semibold">Average Rating: {{ movie.average_stars }} <i
                    class="fa-solid fa-star star-rating"></i> ({{ total_reviews }})</h2>
            {% endwith %}
        </div>
    </div>
    <div class="row pb-2">
        <div class="col-md-4 movie-details">
            <h4 class="text-center fw-bold">Movie Information</h4>
            <hr>
            <p><span class="fw-semibold">Genre:</span> {{ movie.genre }}</p>
            <p><span class="fw-semibold">Release Date:</span> {{ movie.release_date }}</p>
            <p><span class="fw-semibold">Directed by:</span> {{ movie.director }}</p>
            <p><span class="fw-semibold">Age Rating:</span> {{ movie.age_rating }}</p>
        </div>
        <div class="col-md-8 movie-details">
            <h4 class="text-center fw-bold">Summary</h4>
            <hr>
            <p>{{ movie.summary | safe }}</p>
        </div>
    </div>

    <div class="row">
        <h4>Reviews</h4>
        <div class="col-12 pb-3">
            {% if reviewed == False %}
            {% if user.is_authenticated %}
            <h5>Leave a review as: {{ user.username }}</h3>
            <form action="" method="post">
                {{ review_form | crispy }}
                {% csrf_token%}
            </form>
            {% endif %}
            {% endif %}
        </div>
    </div>
</div>

{% endblock %}